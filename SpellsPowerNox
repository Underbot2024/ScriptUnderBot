setDefaultTab("Tools")
local allowedNames = {
  "Power Abused",
  "Power Abuser",
  "Ilegal God",
  "Illegal Power",
  "Dios",
  "Supreme",
  "Extssy",
  "Power Strike",
  "Amazing Power",
}

if not table.find(allowedNames, name(), true) then
  -- Mostrar un cuadro de informacion en lugar de una ventana de texto
  modules.corelib.displayInfoBox(tr("Error"), name() .. ", Tu no tienes permitido usar estos scripts.", "Scripts Underbot")
  return
end

modules.game_textmessage.displayGameMessage("Scripts Protegidos Cargados.")

-- Magias Paladin
g_ui.loadUIFromString([[
ConfigWindow < MainWindow
  size: 150 210

  Label
    id: titleMagias
    text: SPELLS   PALADIN
    font: verdana-11px-rounded
    color: #a73ec1
    margin-top: -30
    anchors.top: parent.top
    anchors.horizontalCenter: parent.horizontalCenter

  Panel
    id: lista
    anchors.fill: parent
    anchors.bottom: closeButton.top
    layout:
      type: grid
      cell-size: 110 15
      cell-spacing: 2

  Button
    id: closeButton
    text: Close
    font: cipsoftFont
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    size: 45 21
]])

local panelName = "config"
if not storage[panelName] then
  storage[panelName] = {
    enabled = false,
  }
end

local config = storage[panelName]

local rootWidget = g_ui.getRootWidget()
local configWindow = UI.createWindow('ConfigWindow', rootWidget)
configWindow:hide()

local listaMacros = {}

-- aqui van los macros

-- Antipk
local singleTargetSpell = 'exori con'
local multiTargetSpell = 'exevo mas san'
local distance = 4
local amountOfMonsters = 3

local antipkrp = macro(2000, "Antipk", function()
    local isSafe = true
    local specAmount = 0
    if not g_game.isAttacking() then
        return
    end
for i,mob in ipairs(getSpectators()) do
        if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
            specAmount = specAmount + 1
        end
        if (mob:isPlayer() and (player:getName() ~= mob:getName()) and g_game.isAttacking (storage.Spell1)) then
            isSafe = false
        end
    end
    if (specAmount >= amountOfMonsters) and isSafe then
        say( multiTargetSpell )
    else
        say( singleTargetSpell )
    end
end)

-- mspell no antipk
local singleTargetSpell = 'exori con'
local multiTargetSpell = 'exevo mas san'
local distance = 4
local amountOfMonsters = 3

local noantipkrp = macro(2000, "Mspell", function()
    if not g_game.isAttacking() then
        return
    end

    local specAmount = 0

    for _, mob in ipairs(getSpectators()) do
        if mob:isMonster() and getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance then
            specAmount = specAmount + 1
        end
    end

    if specAmount >= amountOfMonsters then
        say(multiTargetSpell)
    else
        say(singleTargetSpell)
    end
end)

local exoricon = macro(2000, "Exori con", function()
    if g_game.isAttacking() then
        say("exori con")
    end
end)

local exorisan = macro(2000, "Exori san", function()
    if g_game.isAttacking() then
        say("exori san")
    end
end)

local exevomasan = macro(2000, "Exevo mas san", function()
    if g_game.isAttacking() then
        say("exevo mas san")
    end
end)

local UtitoTempoSan = macro(2000, "utito tempo san", function()
        say("utito tempo san")
    end)

local config = {
    distance = 2, -- Define la distancia maxima para contar monstruos
    spell = "utito tempo san" -- Define el hechizo a lanzar
}

local UtitoTempoPro = macro(300, "utito tempo pro", function()
    if hasPartyBuff() then return end

    local playerPosition = g_game.getLocalPlayer():getPosition()
    local monstersScreen = g_map.getSpectators(playerPosition, false) 
    local monsterCount = 0

    for _, creature in ipairs(monstersScreen) do
        if creature:isMonster() then
            local creaturePosition = creature:getPosition()
            local distance = math.max(math.abs(creaturePosition.x - playerPosition.x), 
                                      math.abs(creaturePosition.y - playerPosition.y))
            if distance <= config.distance then
                monsterCount = monsterCount + 1
            end
        end
    end

    if monsterCount >= 2 then
        say(config.spell)
    end
end, false)

-- Utana Vid
local config = {
    invisibleSpell = "Utana Vid",
    minManaPercent = 10,
    useOnPz = true
}

local utana = macro(500, config.invisibleSpell, function()
    local isVisible = not player:isInvisible() 
    local hasMana = manapercent() > config.minManaPercent
    local isPzOk = config.useOnPz or not isInPz()
    if isVisible and hasMana and isPzOk then
        say(config.invisibleSpell)
        delay(1000)
    end
end)

-- aqui los agregas a la ventana 
table.insert(listaMacros, antipkrp)
table.insert(listaMacros, noantipkrp)
table.insert(listaMacros, exoricon)
table.insert(listaMacros, exorisan)
table.insert(listaMacros, exevomasan)
table.insert(listaMacros, UtitoTempoSan)
table.insert(listaMacros, UtitoTempoPro)
table.insert(listaMacros, utana)
local checkboxes = {}

for _, mac in ipairs(listaMacros) do
    local checkbox = g_ui.createWidget("CheckBox", configWindow.lista)
    checkbox:setText(mac.switch:getText())
    checkbox.onCheckChange = function(wid, isChecked)
        mac.setOn(isChecked)
    end
    checkbox:setChecked(mac.isOn())
    mac.switch:setVisible(false)
    table.insert(checkboxes, checkbox)
    
     -- Tooltip para "Antipkrp"
    if mac.switch:getText() == "Antipk" then
        checkbox:setTooltip("Este spell lanza exori con y si hay mas de 3 monster lanza Mas san Cuidando no sacar Pk.")
    end  
     -- Tooltip para "Multispell"
    if mac.switch:getText() == "Mspell" then
        checkbox:setTooltip("Este spell lanza exori con y si hay mas de 3 monster lanza Mas san, No es antipk.")
   end
      -- Tooltip para "UtitoTempoPro"
    if mac.switch:getText() == "utito tempo pro" then
        checkbox:setTooltip("Este spell lanza utito tempo san,si hay mas de 2 monster en un rango de 2sqm.")
    end
end

configWindow.closeButton.onClick = function(widget)
    configWindow:hide()
end

-- Boton para abrir la ventana
local openButton = UI.Button("Magias Paladin", function()
    configWindow:show()
    configWindow:setFocusable(false)
    configWindow:raise()
    configWindow:focus()
end)
openButton:setColor("#00FFFF") -- Color cian

-- Animacion de brillo para el titulo
local titleMagias = configWindow.titleMagias
local text = "SPELLS   PALADIN"
local glowPosition = 1
local glowDirection = 1

macro(50, function()
    local numChars = #text
    local glowRange = math.max(1, math.floor(numChars / 10)) 
    local coloredText = {}

    for i = 1, numChars do
        local char = text:sub(i, i)
        local color = "#a73ec1" -- Color base
        if math.abs(i - glowPosition) <= glowRange then
            color = "#dfbae9" -- Color de brillo
        end
        table.insert(coloredText, char)
        table.insert(coloredText, color)
    end

    glowPosition = glowPosition + glowDirection
    if glowPosition > numChars then
        glowPosition = numChars - 1
        glowDirection = -1
    elseif glowPosition < 1 then
        glowPosition = 2
        glowDirection = 1
    end

    titleMagias:setColoredText(coloredText)
end)
-- Magias Knight
g_ui.loadUIFromString([[
ConfigWindow < MainWindow
  size: 150 250

  Label
    id: titleMagias
    text: SPELLS   KNIGHT
    font: verdana-11px-rounded
    color: #a73ec1
    margin-top: -30
    anchors.top: parent.top
    anchors.horizontalCenter: parent.horizontalCenter

  Panel
    id: lista
    anchors.fill: parent
    anchors.bottom: closeButton.top
    layout:
      type: grid
      cell-size: 110 15
      cell-spacing: 2

  Button
    id: closeButton
    text: Close
    font: cipsoftFont
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    size: 45 21
]])

local panelName = "config"
if not storage[panelName] then
  storage[panelName] = {
    enabled = false,
  }
end

local config = storage[panelName]

local rootWidget = g_ui.getRootWidget()
local configWindow = UI.createWindow('ConfigWindow', rootWidget)
configWindow:hide()

local listaMacros = {}

-- aqui van los macros

-- AntiPk Hur&Exori
local singleTargetSpell = 'exori hur'
local multiTargetSpell = 'exori'
local distance =1
local amountOfMonsters = 2

local antipkexori = macro(2000, "Antipk Exori", function()
    local isSafe = true
    local specAmount = 0
    if not g_game.isAttacking() then
        return
    end
for i,mob in ipairs(getSpectators()) do
        if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
            specAmount = specAmount + 1
        end
        if (mob:isPlayer() and (player:getName() ~= mob:getName()) and g_game.isAttacking (storage.Spell1)) then
            isSafe = false
        end
    end
    if (specAmount >= amountOfMonsters) and isSafe then
        say( multiTargetSpell )
    else
        say( singleTargetSpell )
    end
end)

-- AntiPk Hur&Exgran
local singleTargetSpell = 'exori hur'
local multiTargetSpell = 'exori gran'
local distance =1
local amountOfMonsters = 2

local antipkexgran = macro(2000, "Antipk Exgran", function()
    local isSafe = true
    local specAmount = 0
    if not g_game.isAttacking() then
        return
    end
for i,mob in ipairs(getSpectators()) do
        if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
            specAmount = specAmount + 1
        end
        if (mob:isPlayer() and (player:getName() ~= mob:getName()) and g_game.isAttacking (storage.Spell1)) then
            isSafe = false
        end
    end
    if (specAmount >= amountOfMonsters) and isSafe then
        say( multiTargetSpell )
    else
        say( singleTargetSpell )
    end
end)

-- Mspell no antipk Hur&Exori
local singleTargetSpell = 'exori hur'
local multiTargetSpell = 'exori'
local distance = 4
local amountOfMonsters = 2

local hurYexori = macro(2000, "Hur & Exori", function()
    if not g_game.isAttacking() then
        return
    end

    local specAmount = 0

    for _, mob in ipairs(getSpectators()) do
        if mob:isMonster() and getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance then
            specAmount = specAmount + 1
        end
    end

    if specAmount >= amountOfMonsters then
        say(multiTargetSpell)
    else
        say(singleTargetSpell)
    end
end)

-- Mspell no antipk Hur&Exgran
local singleTargetSpell = 'exori hur'
local multiTargetSpell = 'exori gran'
local distance = 4
local amountOfMonsters = 2

local hurYexgran = macro(2000, "Hur & Exgran", function()
    if not g_game.isAttacking() then
        return
    end

    local specAmount = 0

    for _, mob in ipairs(getSpectators()) do
        if mob:isMonster() and getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance then
            specAmount = specAmount + 1
        end
    end

    if specAmount >= amountOfMonsters then
        say(multiTargetSpell)
    else
        say(singleTargetSpell)
    end
end)

local exori = macro(2000, "Exori", function()
    if g_game.isAttacking() then
        say("exori")
    end
end)

local exorihur = macro(2000, "Exori hur", function()
    if g_game.isAttacking() then
        say("exori hur")
    end
end)

local exorigran = macro(2000, "Exori gran", function()
    if g_game.isAttacking() then
        say("exori gran")
    end
end)

local exorimas = macro(2000, "Exori Mas", function()
    if g_game.isAttacking() then
        say("exori mas")
    end
end)

local UtitoTempo = macro(2000, "utito tempo", function()
    if g_game.isAttacking() then
        say("utito tempo")
    end
end)

local config = {
    distance = 2, -- Define la distancia maxima para contar monstruos
    spell = "utito tempo" -- Define el hechizo a lanzar
}

local UtitoTempoPro = macro(300, "utito tempo pro", function()
    if hasPartyBuff() then return end

    local playerPosition = g_game.getLocalPlayer():getPosition()
    local monstersScreen = g_map.getSpectators(playerPosition, false) 
    local monsterCount = 0

    for _, creature in ipairs(monstersScreen) do
        if creature:isMonster() then
            local creaturePosition = creature:getPosition()
            local distance = math.max(math.abs(creaturePosition.x - playerPosition.x), 
                                      math.abs(creaturePosition.y - playerPosition.y))
            if distance <= config.distance then
                monsterCount = monsterCount + 1
            end
        end
    end

    if monsterCount >= 2 then
        say(config.spell)
    end
end, false)

-- aqui los agregas a la ventana 
table.insert(listaMacros, antipkexori)
table.insert(listaMacros, antipkexgran)
table.insert(listaMacros, hurYexori)
table.insert(listaMacros, hurYexgran)
table.insert(listaMacros, exori)
table.insert(listaMacros, exorihur)
table.insert(listaMacros, exorigran)
table.insert(listaMacros, exorimas)
table.insert(listaMacros, UtitoTempo)
table.insert(listaMacros, UtitoTempoPro)

local checkboxes = {}

for _, mac in ipairs(listaMacros) do
    local checkbox = g_ui.createWidget("CheckBox", configWindow.lista)
    checkbox:setText(mac.switch:getText())
    checkbox.onCheckChange = function(wid, isChecked)
        mac.setOn(isChecked)
    end
    checkbox:setChecked(mac.isOn())
    mac.switch:setVisible(false)
    table.insert(checkboxes, checkbox)
    
    -- Tooltip para "Antipk Exori"
    if mac.switch:getText() == "Antipk Exori" then
        checkbox:setTooltip("Este spell lanza Exori hur & si hay mas de 2 monster lanza Exori Cuidando no sacar Pk.")
    end   
     -- Tooltip para "Antipk Exgran"
    if mac.switch:getText() == "Antipk Exgran" then
        checkbox:setTooltip("Este spell lanza Exori hur & si hay mas de 2 monster lanza Exori gran Cuidando no sacar Pk.")
    end
 -- Tooltip para "Hur&Exori"
    if mac.switch:getText() == "Hur & Exori" then
        checkbox:setTooltip("Este spell lanza exori hur & si hay mas de 2 monster lanza Exori, si hay players igual lanzara Exori.")
    end
    -- Tooltip para "Hur&Exgran"
    if mac.switch:getText() == "Hur & Exgran" then
        checkbox:setTooltip("Este spell lanza Exori hur & si hay mas de 2 monster lanza Exori gran, si hay players igual lanzara Exori gran.")
    end
    -- Tooltip para "UtitoTempoPro"
    if mac.switch:getText() == "utito tempo pro" then
        checkbox:setTooltip("Este spell lanzara utito tempo si hay 2 o mas monster en un rango de 2sqm.")
    end
end

configWindow.closeButton.onClick = function(widget)
    configWindow:hide()
end

-- Boton para abrir la ventana
local openButton = UI.Button("Magias Knight", function()
    configWindow:show()
    configWindow:setFocusable(false)
    configWindow:raise()
    configWindow:focus()
end)
openButton:setColor("#00FFFF") -- Color cian

-- Animacion de brillo para el titulo
local titleMagias = configWindow.titleMagias
local text = "SPELLS   KNIGHT"
local glowPosition = 1
local glowDirection = 1

macro(50, function()
    local numChars = #text
    local glowRange = math.max(1, math.floor(numChars / 10)) 
    local coloredText = {}

    for i = 1, numChars do
        local char = text:sub(i, i)
        local color = "#a73ec1" -- Color base
        if math.abs(i - glowPosition) <= glowRange then
            color = "#dfbae9" -- Color de brillo
        end
        table.insert(coloredText, char)
        table.insert(coloredText, color)
    end

    glowPosition = glowPosition + glowDirection
    if glowPosition > numChars then
        glowPosition = numChars - 1
        glowDirection = -1
    elseif glowPosition < 1 then
        glowPosition = 2
        glowDirection = 1
    end

    titleMagias:setColoredText(coloredText)
end)
-- Magias Sorcerer
g_ui.loadUIFromString([[
ConfigWindow < MainWindow
  size: 150 330

  Label
    id: titleMagias
    text: SPELLS   SORCERER
    font: verdana-11px-rounded
    color: #a73ec1
    margin-top: -30
    anchors.top: parent.top
    anchors.horizontalCenter: parent.horizontalCenter

  Panel
    id: lista
    anchors.fill: parent
    anchors.bottom: closeButton.top
    layout:
      type: grid
      cell-size: 110 15
      cell-spacing: 2

  Button
    id: closeButton
    text: Close
    font: cipsoftFont
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    size: 45 21
]])

local panelName = "config"
if not storage[panelName] then
  storage[panelName] = {
    enabled = false,
  }
end

local config = storage[panelName]

local rootWidget = g_ui.getRootWidget()
local configWindow = UI.createWindow('ConfigWindow', rootWidget)
configWindow:hide()

local listaMacros = {}

-- Macros de hechizos

--- Antipk Mas vis
local idRune = 3155
local multiTargetSpell = 'exevo gran mas vis'
local distance = 5
local amountOfMonsters = 3

local antipkvis = macro(2000, "Antipk Vis", function()
local isSafe = true
local specAmount = 0

if not g_game.isAttacking() then
    return
end

for i,mob in ipairs(getSpectators()) do
    if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
        specAmount = specAmount + 1
    end
    if (mob:isPlayer() and (player:getName() ~= mob:getName()) and g_game.isAttacking(storage.Spell1)) then
        isSafe = false
    end
end

if (specAmount >= amountOfMonsters) and isSafe then
    say(multiTargetSpell)
else
    local attackingCreature = g_game.getAttackingCreature()
    if attackingCreature then
        g_game.useInventoryItemWith(idRune, attackingCreature)
    end
end
end)

--- Antipk Mas flam
local idRune = 3155
local multiTargetSpell = 'exevo gran mas flam'
local distance = 5
local amountOfMonsters = 3

local antipkflam = macro(2000, "Antipk Flam", function()
local isSafe = true
local specAmount = 0

if not g_game.isAttacking() then
    return
end

for i,mob in ipairs(getSpectators()) do
    if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
        specAmount = specAmount + 1
    end
    if (mob:isPlayer() and (player:getName() ~= mob:getName()) and g_game.isAttacking(storage.Spell1)) then
        isSafe = false
    end
end

if (specAmount >= amountOfMonsters) and isSafe then
    say(multiTargetSpell)
else
    local attackingCreature = g_game.getAttackingCreature()
    if attackingCreature then
        g_game.useInventoryItemWith(idRune, attackingCreature)
    end
end
end)

-- mspell no antipk SD&Vis
local idRune = 3155
local multiTargetSpell = 'exevo gran mas vis'
local distance = 5
local amountOfMonsters = 3

local sdYvis = macro(2000, "SD & Vis", function()
    local specAmount = 0

    if not g_game.isAttacking() then
        return
    end

    for i, mob in ipairs(getSpectators()) do
        if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
            specAmount = specAmount + 1
        end
    end

    if (specAmount >= amountOfMonsters) then
        say(multiTargetSpell)
    else
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature then
            g_game.useInventoryItemWith(idRune, attackingCreature)
        end
    end
end)

-- Mspell no antipk SD&Flam
local idRune = 3155
local multiTargetSpell = 'exevo gran mas flam'
local distance = 5
local amountOfMonsters = 3

local sdYflam = macro(2000, "SD & Flam", function()
    local specAmount = 0

    if not g_game.isAttacking() then
        return
    end

    for i, mob in ipairs(getSpectators()) do
        if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
            specAmount = specAmount + 1
        end
    end

    if (specAmount >= amountOfMonsters) then
        say(multiTargetSpell)
    else
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature then
            g_game.useInventoryItemWith(idRune, attackingCreature)
        end
    end
end)

--- Hold SD
local sd = macro(2000, "SD rune", function()
    if g_game.isAttacking() then
        usewith(3155, g_game.getAttackingCreature())
        delay(1000)
    end
end)

local aoe = macro(2000, "AOE rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3161) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3161, attackingCreature)  
        end
    end  
end, false)

local gfr = macro(2000, "GFR rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3191) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3191, attackingCreature)  
        end
    end  
end, false)

local exorivis = macro(2000, "Exori vis", function()
    if g_game.isAttacking() then
        say("exori vis")
    end
end)

local exoriflam = macro(2000, "Exori flam", function()
    if g_game.isAttacking() then
        say("exori flam")
    end
end)

local exorimort = macro(2000, "Exori mort", function()
    if g_game.isAttacking() then
        say("exori mort")
    end
end)

-- Exevo vis hur
local max_distance = 5 -- Distancia maxima permitida para lanzar el hechizo

local function turnToTarget()
    local enemy = target()
    if not enemy then return false end
    local pos = player:getPosition()
    local cpos = enemy:getPosition()

    if not pos or not cpos then return false end

    -- Verifica si el enemigo esta dentro de la distancia permitida
    if getDistanceBetween(pos, cpos) > max_distance then return false end

    local diffx = cpos.x - pos.x
    local diffy = cpos.y - pos.y
    local turned = false

    if diffx > 0 and diffy == 0 then turn(1) turned = true -- Derecha
    elseif diffx < 0 and diffy == 0 then turn(3) turned = true -- Izquierda
    elseif diffx == 0 and diffy > 0 then turn(2) turned = true -- Abajo
    elseif diffx == 0 and diffy < 0 then turn(0) turned = true -- Arriba
    end 

    if turned then delay(200) end -- Espera 200ms para asegurarse de que giró antes de lanzar el hechizo
    return turned
end

-- Macro para "exevo vis hur" con distancia maxima
local exevovishur = macro(2000, "Exevo vis hur", function()
    if g_game.isAttacking() and turnToTarget() then
        say("exevo vis hur")
    end
end)

-- Exevo flam hur
local max_distance = 5 -- Distancia maxima permitida para lanzar el hechizo

local function turnToTarget()
    local enemy = target()
    if not enemy then return false end
    local pos = player:getPosition()
    local cpos = enemy:getPosition()

    if not pos or not cpos then return false end

    -- Verifica si el enemigo esta dentro de la distancia permitida
    if getDistanceBetween(pos, cpos) > max_distance then return false end

    local diffx = cpos.x - pos.x
    local diffy = cpos.y - pos.y
    local turned = false

    if diffx > 0 and diffy == 0 then turn(1) turned = true -- Derecha
    elseif diffx < 0 and diffy == 0 then turn(3) turned = true -- Izquierda
    elseif diffx == 0 and diffy > 0 then turn(2) turned = true -- Abajo
    elseif diffx == 0 and diffy < 0 then turn(0) turned = true -- Arriba
    end 

    if turned then delay(200) end -- Espera 200ms para asegurarse de que giró antes de lanzar el hechizo
    return turned
end

-- Macro para "exevo flam hur" con distancia maxima
local exevoflamhur = macro(2000, "Exevo flam hur", function()
    if g_game.isAttacking() and turnToTarget() then
        say("exevo flam hur")
    end
end)

local masvis = macro(2000, "Mas Vis", function()
    if g_game.isAttacking() then
        say("exevo gran mas vis")
    end
end)

local masflam = macro(2000, "Mas flam", function()
    if g_game.isAttacking() then
        say("exevo gran mas flam")
    end
end)

-- Utana Vid
local config = {
    invisibleSpell = "Utana Vid",
    minManaPercent = 10,
    useOnPz = true
}

local utana = macro(500, config.invisibleSpell, function()
    local isVisible = not player:isInvisible() 
    local hasMana = manapercent() > config.minManaPercent
    local isPzOk = config.useOnPz or not isInPz()
    if isVisible and hasMana and isPzOk then
        say(config.invisibleSpell)
        delay(1000)
    end
end)

-- Agregar macros a la lista
table.insert(listaMacros, antipkvis)
table.insert(listaMacros, antipkflam)
table.insert(listaMacros, sdYvis)
table.insert(listaMacros, sdYflam)
table.insert(listaMacros, sd)
table.insert(listaMacros, aoe)
table.insert(listaMacros, gfr)
table.insert(listaMacros, exorivis)
table.insert(listaMacros, exoriflam)
table.insert(listaMacros, exorimort)
table.insert(listaMacros, exevovishur)
table.insert(listaMacros, exevoflamhur)
table.insert(listaMacros, masvis)
table.insert(listaMacros, masflam)
table.insert(listaMacros, utana)
checkboxes = {}

for _, mac in ipairs(listaMacros) do
    local checkbox = g_ui.createWidget("CheckBox", configWindow.lista)
    checkbox:setText(mac.switch:getText())
    checkbox.onCheckChange = function(wid, isChecked)
        mac.setOn(isChecked)
    end
    checkbox:setChecked(mac.isOn())
    mac.switch:setVisible(false)
    table.insert(checkboxes, checkbox)
    
    -- Tooltip para "Antipk Vis"
    if mac.switch:getText() == "Antipk Vis" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas Vis Cuidando no sacar Pk.")
    end   
    -- Tooltip para "Antipk Flam"
    if mac.switch:getText() == "Antipk Flam" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas Flam Cuidando no sacar Pk.")
    end
   -- Tooltip para "Sd&Vis"
    if mac.switch:getText() == "SD & Vis" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas Vis, si hay players igual lanzara Ue.")
    end
     -- Tooltip para "Sd&Flam"
    if mac.switch:getText() == "SD & Flam" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas Flam, si hay players igual lanzara Ue.")
    end
       -- Tooltip para "Exevo vis hur"
    if mac.switch:getText() == "Exevo vis hur" then
        checkbox:setTooltip("Gira hacia el enemigo y lanza Vis Hur si esta dentro del rango de 5 sqm,evita lanzar el echizo en direcciones incorrectas..")
    end
    -- Tooltip para "Exevo flam hur"
    if mac.switch:getText() == "Exevo flam hur" then
        checkbox:setTooltip("Gira hacia el enemigo y lanza Flam Hur si esta dentro del rango de 5 sqm,evita lanzar el echizo en direcciones incorrectas..")
    end
  end

configWindow.closeButton.onClick = function(widget)
    configWindow:hide()
end

-- Botón para abrir la ventana
local openButton = UI.Button("Magias Sorcerer", function()
    configWindow:show()
    configWindow:setFocusable(false)
    configWindow:raise()
    configWindow:focus()
end)
openButton:setColor("#00FFFF") -- Color cian

-- Animación de brillo para el título
local titleMagias = configWindow.titleMagias
local text = "SPELLS   SORCERER"
local glowPosition = 1
local glowDirection = 1

macro(50, function()
    local numChars = #text
    local glowRange = math.max(1, math.floor(numChars / 10)) 
    local coloredText = {}

    for i = 1, numChars do
        local char = text:sub(i, i)
        local color = "#a73ec1" -- Color base
        if math.abs(i - glowPosition) <= glowRange then
            color = "#dfbae9" -- Color de brillo
        end
        table.insert(coloredText, char)
        table.insert(coloredText, color)
    end

    glowPosition = glowPosition + glowDirection
    if glowPosition > numChars then
        glowPosition = numChars - 1
        glowDirection = -1
    elseif glowPosition < 1 then
        glowPosition = 2
        glowDirection = 1
    end

    titleMagias:setColoredText(coloredText)
end)
-- Magias Druid
g_ui.loadUIFromString([[
ConfigWindow < MainWindow
  size: 150 330

  Label
    id: titleMagias
    text: SPELLS   DRUID
    font: verdana-11px-rounded
    color: #a73ec1
    margin-top: -30
    anchors.top: parent.top
    anchors.horizontalCenter: parent.horizontalCenter

  Panel
    id: lista
    anchors.fill: parent
    anchors.bottom: closeButton.top
    layout:
      type: grid
      cell-size: 110 15
      cell-spacing: 2

  Button
    id: closeButton
    text: Close
    font: cipsoftFont
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    size: 45 21
]])

local panelName = "config"
if not storage[panelName] then
  storage[panelName] = {
    enabled = false,
  }
end

local config = storage[panelName]

local rootWidget = g_ui.getRootWidget()
local configWindow = UI.createWindow('ConfigWindow', rootWidget)
configWindow:hide()

local listaMacros = {}

-- Macros de hechizos

--- Antipk Mas frigo
local idRune = 3155
local multiTargetSpell = 'exevo gran mas frigo'
local distance = 5
local amountOfMonsters = 3

local antipkfrigo = macro(2000, "Antipk Frigo", function()
local isSafe = true
local specAmount = 0

if not g_game.isAttacking() then
    return
end

for i,mob in ipairs(getSpectators()) do
    if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
        specAmount = specAmount + 1
    end
    if (mob:isPlayer() and (player:getName() ~= mob:getName()) and g_game.isAttacking(storage.Spell1)) then
        isSafe = false
    end
end

if (specAmount >= amountOfMonsters) and isSafe then
    say(multiTargetSpell)
else
    local attackingCreature = g_game.getAttackingCreature()
    if attackingCreature then
        g_game.useInventoryItemWith(idRune, attackingCreature)
    end
end
end)

--- Antipk Mas tera
local idRune = 3155
local multiTargetSpell = 'exevo gran mas tera'
local distance = 5
local amountOfMonsters = 3

local antipktera = macro(2000, "Antipk Tera", function()
local isSafe = true
local specAmount = 0

if not g_game.isAttacking() then
    return
end

for i,mob in ipairs(getSpectators()) do
    if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
        specAmount = specAmount + 1
    end
    if (mob:isPlayer() and (player:getName() ~= mob:getName()) and g_game.isAttacking(storage.Spell1)) then
        isSafe = false
    end
end

if (specAmount >= amountOfMonsters) and isSafe then
    say(multiTargetSpell)
else
    local attackingCreature = g_game.getAttackingCreature()
    if attackingCreature then
        g_game.useInventoryItemWith(idRune, attackingCreature)
    end
end
end)

-- SD&Frigo
local idRune = 3155
local multiTargetSpell = 'exevo gran mas frigo'
local distance = 5
local amountOfMonsters = 3

local sdYfrigo = macro(2000, "SD & Frigo", function()
    local specAmount = 0

    if not g_game.isAttacking() then
        return
    end

    for i, mob in ipairs(getSpectators()) do
        if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
            specAmount = specAmount + 1
        end
    end

    if (specAmount >= amountOfMonsters) then
        say(multiTargetSpell)
    else
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature then
            g_game.useInventoryItemWith(idRune, attackingCreature)
        end
    end
end)

-- SD&Tera
local idRune = 3155
local multiTargetSpell = 'exevo gran mas tera'
local distance = 5
local amountOfMonsters = 3

local sdYtera = macro(2000, "SD & Tera", function()
    local specAmount = 0

    if not g_game.isAttacking() then
        return
    end

    for i, mob in ipairs(getSpectators()) do
        if (getDistanceBetween(player:getPosition(), mob:getPosition()) <= distance and mob:isMonster()) then
            specAmount = specAmount + 1
        end
    end

    if (specAmount >= amountOfMonsters) then
        say(multiTargetSpell)
    else
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature then
            g_game.useInventoryItemWith(idRune, attackingCreature)
        end
    end
end)

--- Hold SD
local sd = macro(2000, "SD rune", function()
    if g_game.isAttacking() then
        usewith(3155, g_game.getAttackingCreature())
        delay(1000)
    end
end)

local aoe = macro(2000, "AOE rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3161) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3161, attackingCreature)  
        end
    end  
end, false)

local gfr = macro(2000, "GFR rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3191) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3191, attackingCreature)  
        end
    end  
end, false)

local exorifrigo = macro(2000, "Exori frigo", function()
    if g_game.isAttacking() then
        say("exori frigo")
    end
end)

local exoritera = macro(2000, "Exori tera", function()
    if g_game.isAttacking() then
        say("exori tera")
    end
end)

-- Exevo frigo hur
local max_distance = 5 -- Distancia maxima permitida para lanzar el hechizo

local function turnToTarget()
    local enemy = target()
    if not enemy then return false end
    local pos = player:getPosition()
    local cpos = enemy:getPosition()

    if not pos or not cpos then return false end

    -- Verifica si el enemigo esta dentro de la distancia permitida
    if getDistanceBetween(pos, cpos) > max_distance then return false end

    local diffx = cpos.x - pos.x
    local diffy = cpos.y - pos.y
    local turned = false

    if diffx > 0 and diffy == 0 then turn(1) turned = true -- Derecha
    elseif diffx < 0 and diffy == 0 then turn(3) turned = true -- Izquierda
    elseif diffx == 0 and diffy > 0 then turn(2) turned = true -- Abajo
    elseif diffx == 0 and diffy < 0 then turn(0) turned = true -- Arriba
    end 

    if turned then delay(200) end -- Espera 200ms para asegurarse de que giró antes de lanzar el hechizo
    return turned
end

-- Macro para "exevo frigo hur" con distancia maxima
local exevofrigohur = macro(2000, "Exevo frigo hur", function()
    if g_game.isAttacking() and turnToTarget() then
        say("exevo frigo hur")
    end
end)

-- Exevo tera hur
local max_distance = 5 -- Distancia maxima permitida para lanzar el hechizo

local function turnToTarget()
    local enemy = target()
    if not enemy then return false end
    local pos = player:getPosition()
    local cpos = enemy:getPosition()

    if not pos or not cpos then return false end

    -- Verifica si el enemigo esta dentro de la distancia permitida
    if getDistanceBetween(pos, cpos) > max_distance then return false end

    local diffx = cpos.x - pos.x
    local diffy = cpos.y - pos.y
    local turned = false

    if diffx > 0 and diffy == 0 then turn(1) turned = true -- Derecha
    elseif diffx < 0 and diffy == 0 then turn(3) turned = true -- Izquierda
    elseif diffx == 0 and diffy > 0 then turn(2) turned = true -- Abajo
    elseif diffx == 0 and diffy < 0 then turn(0) turned = true -- Arriba
    end 

    if turned then delay(200) end -- Espera 200ms para asegurarse de que giró antes de lanzar el hechizo
    return turned
end

-- Macro para "exevo tera hur" con distancia maxima
local exevoterahur = macro(2000, "Exevo tera hur", function()
    if g_game.isAttacking() and turnToTarget() then
        say("exevo tera hur")
    end
end)

local masfrigo = macro(2000, "Mas frigo", function()
    if g_game.isAttacking() then
        say("exevo gran mas frigo")
    end
end)

local mastera = macro(2000, "Mas tera", function()
    if g_game.isAttacking() then
        say("exevo gran mas tera")
    end
end)

local masres = macro(2000, "Mas res", function()
say("exura gran mas res")
end, false)

-- Utana Vid
local config = {
    invisibleSpell = "Utana Vid",
    minManaPercent = 10,
    useOnPz = true
}

local utana = macro(500, config.invisibleSpell, function()
    local isVisible = not player:isInvisible() 
    local hasMana = manapercent() > config.minManaPercent
    local isPzOk = config.useOnPz or not isInPz()
    if isVisible and hasMana and isPzOk then
        say(config.invisibleSpell)
        delay(1000)
    end
end)

-- Agregar macros a la lista
table.insert(listaMacros, antipkfrigo)
table.insert(listaMacros, antipktera)
table.insert(listaMacros, sdYfrigo)
table.insert(listaMacros, sdYtera)
table.insert(listaMacros, sd)
table.insert(listaMacros, aoe)
table.insert(listaMacros, gfr)
table.insert(listaMacros, exorifrigo)
table.insert(listaMacros, exoritera)
table.insert(listaMacros, exevofrigohur)
table.insert(listaMacros, exevoterahur)
table.insert(listaMacros, masfrigo)
table.insert(listaMacros, mastera)
table.insert(listaMacros, masres)
table.insert(listaMacros, utana)
checkboxes = {}

for _, mac in ipairs(listaMacros) do
    local checkbox = g_ui.createWidget("CheckBox", configWindow.lista)
    checkbox:setText(mac.switch:getText())
    checkbox.onCheckChange = function(wid, isChecked)
        mac.setOn(isChecked)
    end
    checkbox:setChecked(mac.isOn())
    mac.switch:setVisible(false)
    table.insert(checkboxes, checkbox)
    
    -- Tooltip para "Antipk frigo"
    if mac.switch:getText() == "Antipk Frigo" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas frigo Cuidando no sacar pk.")
    end   
    -- Tooltip para "Antipk tera"
    if mac.switch:getText() == "Antipk Tera" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas tera Cuidando no sacar pk.")
    end
   -- Tooltip para "SD&Frigo"
    if mac.switch:getText() == "SD & Frigo" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas frigo, si hay players igual lanzara Ue.")
    end
     -- Tooltip para "SD&Tera"
    if mac.switch:getText() == "SD & Tera" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas tera, si hay players igual lanzara Ue.")
    end
       -- Tooltip para "Exevo frigo hur"
    if mac.switch:getText() == "Exevo frigo hur" then
        checkbox:setTooltip("Gira hacia el enemigo y lanza Frigo Hur si esta dentro del rango de 5 sqm,evita lanzar el echizo en direcciones incorrectas..")
    end
    -- Tooltip para "Exevo tera hur"
    if mac.switch:getText() == "Exevo tera hur" then
        checkbox:setTooltip("Gira hacia el enemigo y lanza Frigo Hur si esta dentro del rango de 5 sqm,evita lanzar el echizo en direcciones incorrectas..")
    end
  end

configWindow.closeButton.onClick = function(widget)
    configWindow:hide()
end

-- Botón para abrir la ventana
local openButton = UI.Button("Magias Druid", function()
    configWindow:show()
    configWindow:setFocusable(false)
    configWindow:raise()
    configWindow:focus()
end)
openButton:setColor("#00FFFF") -- Color cian

-- Animación de brillo para el título
local titleMagias = configWindow.titleMagias
local text = "SPELLS   DRUID"
local glowPosition = 1
local glowDirection = 1

macro(50, function()
    local numChars = #text
    local glowRange = math.max(1, math.floor(numChars / 10)) 
    local coloredText = {}

    for i = 1, numChars do
        local char = text:sub(i, i)
        local color = "#a73ec1" -- Color base
        if math.abs(i - glowPosition) <= glowRange then
            color = "#dfbae9" -- Color de brillo
        end
        table.insert(coloredText, char)
        table.insert(coloredText, color)
    end

    glowPosition = glowPosition + glowDirection
    if glowPosition > numChars then
        glowPosition = numChars - 1
        glowDirection = -1
    elseif glowPosition < 1 then
        glowPosition = 2
        glowDirection = 1
    end

    titleMagias:setColoredText(coloredText)
end)


-- Magias Druid
g_ui.loadUIFromString([[
ConfigWindow < MainWindow
  size: 150 140

  Label
    id: titleMagias
    text: SPELLS   SPAM
    font: verdana-11px-rounded
    color: #a73ec1
    margin-top: -30
    anchors.top: parent.top
    anchors.horizontalCenter: parent.horizontalCenter

  Panel
    id: lista
    anchors.fill: parent
    anchors.bottom: closeButton.top
    layout:
      type: grid
      cell-size: 110 15
      cell-spacing: 2

  Button
    id: closeButton
    text: Close
    font: cipsoftFont
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    size: 45 21
]])

local panelName = "config"
if not storage[panelName] then
  storage[panelName] = {
    enabled = false,
  }
end

local config = storage[panelName]

local rootWidget = g_ui.getRootWidget()
local configWindow = UI.createWindow('ConfigWindow', rootWidget)
configWindow:hide()

local listaMacros = {}

-- Macros Spells Spam

local exevofrigohur = macro(1000, "Frigo Hur", function()
    say("exevo frigo hur")
end)

local exevoterahur = macro(1000, "Tera Hur", function()
    say("exevo tera hur")
end)

local masfrigo = macro(1000, "Mas frigo", function()
    say("exevo gran mas frigo")
end)

local mastera = macro(1000, "Mas tera", function()
    say("exevo gran mas tera")
end)

local gfr = macro(1000, "GFR rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3191) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3191, attackingCreature)  
        end
    end  
end, false)

local aoe = macro(1000, "AOE rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3161) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3161, attackingCreature)  
        end
    end  
end, false)

-- Agregar macros a la lista

table.insert(listaMacros, exevofrigohur)
table.insert(listaMacros, exevoterahur)
table.insert(listaMacros, masfrigo)
table.insert(listaMacros, mastera)
table.insert(listaMacros, gfr)
table.insert(listaMacros, aoe)
checkboxes = {}

for _, mac in ipairs(listaMacros) do
    local checkbox = g_ui.createWidget("CheckBox", configWindow.lista)
    checkbox:setText(mac.switch:getText())
    checkbox.onCheckChange = function(wid, isChecked)
        mac.setOn(isChecked)
    end
    checkbox:setChecked(mac.isOn())
    mac.switch:setVisible(false)
    table.insert(checkboxes, checkbox)
    
    -- Tooltip para "Antipk"
    if mac.switch:getText() == "Antipk" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas tera Cuidando no sacar Pk.")
    end
end

configWindow.closeButton.onClick = function(widget)
    configWindow:hide()
end

-- Boton para abrir la ventana
local openButton = UI.Button("Spells Druid Spam", function()
    configWindow:show()
    configWindow:setFocusable(false)
    configWindow:raise()
    configWindow:focus()
end)
openButton:setColor("#00FFFF") -- Color cian

-- Animacion de brillo para el titulo
local titleMagias = configWindow.titleMagias
local text = "SPELLS   SPAM"
local glowPosition = 1
local glowDirection = 1

macro(50, function()
    local numChars = #text
    local glowRange = math.max(1, math.floor(numChars / 10)) 
    local coloredText = {}

    for i = 1, numChars do
        local char = text:sub(i, i)
        local color = "#a73ec1" -- Color base
        if math.abs(i - glowPosition) <= glowRange then
            color = "#dfbae9" -- Color de brillo
        end
        table.insert(coloredText, char)
        table.insert(coloredText, color)
    end

    glowPosition = glowPosition + glowDirection
    if glowPosition > numChars then
        glowPosition = numChars - 1
        glowDirection = -1
    elseif glowPosition < 1 then
        glowPosition = 2
        glowDirection = 1
    end

    titleMagias:setColoredText(coloredText)
end)


-- Magias Sorcerer
g_ui.loadUIFromString([[
ConfigWindow < MainWindow
  size: 150 140

  Label
    id: titleMagias
    text: SPELLS   SPAM
    font: verdana-11px-rounded
    color: #a73ec1
    margin-top: -30
    anchors.top: parent.top
    anchors.horizontalCenter: parent.horizontalCenter

  Panel
    id: lista
    anchors.fill: parent
    anchors.bottom: closeButton.top
    layout:
      type: grid
      cell-size: 110 15
      cell-spacing: 2

  Button
    id: closeButton
    text: Close
    font: cipsoftFont
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    size: 45 21
]])

local panelName = "config"
if not storage[panelName] then
  storage[panelName] = {
    enabled = false,
  }
end

local config = storage[panelName]

local rootWidget = g_ui.getRootWidget()
local configWindow = UI.createWindow('ConfigWindow', rootWidget)
configWindow:hide()

local listaMacros = {}

-- Macros Spells Spam

local exevovishur = macro(1000, "Vis Hur", function()
    say("exevo vis hur")
end)

local exevoflamhur = macro(1000, "Flam Hur", function()
    say("exevo flam hur")
end)

local masvis = macro(1000, "Mas Vis", function()
    say("exevo gran mas vis")
end)

local masflam = macro(1000, "Mas Flam", function()
    say("exevo gran mas flam")
end)

local gfr = macro(1000, "GFR rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3191) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3191, attackingCreature)  
        end
    end  
end, false)

local aoe = macro(1000, "AOE rune", function()  
    if g_game.isAttacking() then  
        local attackingCreature = g_game.getAttackingCreature()
        if attackingCreature and findItem(3161) then  -- Verifica si tienes la runa
            g_game.useInventoryItemWith(3161, attackingCreature)  
        end
    end  
end, false)

-- Agregar macros a la lista

table.insert(listaMacros, exevovishur)
table.insert(listaMacros, exevoflamhur)
table.insert(listaMacros, masvis)
table.insert(listaMacros, masflam)
table.insert(listaMacros, gfr)
table.insert(listaMacros, aoe)
checkboxes = {}

for _, mac in ipairs(listaMacros) do
    local checkbox = g_ui.createWidget("CheckBox", configWindow.lista)
    checkbox:setText(mac.switch:getText())
    checkbox.onCheckChange = function(wid, isChecked)
        mac.setOn(isChecked)
    end
    checkbox:setChecked(mac.isOn())
    mac.switch:setVisible(false)
    table.insert(checkboxes, checkbox)
    
    -- Tooltip para "Antipk"
    if mac.switch:getText() == "Antipk" then
        checkbox:setTooltip("Este hechizo lanza Sd & si hay mas de 3 monster lanza Mas tera Cuidando no sacar Pk.")
    end
end

configWindow.closeButton.onClick = function(widget)
    configWindow:hide()
end

-- Boton para abrir la ventana
local openButton = UI.Button("Spells Sorcerer Spam", function()
    configWindow:show()
    configWindow:setFocusable(false)
    configWindow:raise()
    configWindow:focus()
end)
openButton:setColor("#00FFFF") -- Color cian

-- Animacion de brillo para el titulo
local titleMagias = configWindow.titleMagias
local text = "SPELLS   SPAM"
local glowPosition = 1
local glowDirection = 1

macro(50, function()
    local numChars = #text
    local glowRange = math.max(1, math.floor(numChars / 10)) 
    local coloredText = {}

    for i = 1, numChars do
        local char = text:sub(i, i)
        local color = "#a73ec1" -- Color base
        if math.abs(i - glowPosition) <= glowRange then
            color = "#dfbae9" -- Color de brillo
        end
        table.insert(coloredText, char)
        table.insert(coloredText, color)
    end

    glowPosition = glowPosition + glowDirection
    if glowPosition > numChars then
        glowPosition = numChars - 1
        glowDirection = -1
    elseif glowPosition < 1 then
        glowPosition = 2
        glowDirection = 1
    end

    titleMagias:setColoredText(coloredText)
end)
